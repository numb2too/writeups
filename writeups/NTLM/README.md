NTLMï¼ˆ**NT LAN Manager**ï¼‰æ˜¯ä¸€ç¨®ç”± **Microsoft å¾®è»Ÿ** é–‹ç™¼çš„ **é©—è­‰ï¼ˆAuthenticationï¼‰å”å®š**ï¼Œä¸»è¦ç”¨æ–¼ **Windows ç³»çµ±ä¹‹é–“çš„ç™»å…¥èˆ‡èº«åˆ†é©—è­‰**ã€‚å®ƒæœ€æ—©å‡ºç¾åœ¨ Windows NT æ™‚ä»£ï¼ˆ1990 å¹´ä»£ï¼‰ï¼Œé›–ç„¶ç¾ä»Šå¤šæ•¸ç’°å¢ƒå·²æ”¹ç”¨ **Kerberos**ï¼Œä½† NTLM ä»è¢«ä¿ç•™ä»¥ç¶­æŒèˆŠç³»çµ±æˆ–ç›¸å®¹æ€§ã€‚

---

## ğŸ§© NTLM çš„ç”¨é€”

NTLM ä¸»è¦ç”¨æ–¼ï¼š

* Windows ç™»å…¥ï¼ˆæœ¬æ©Ÿå¸³è™Ÿæˆ–ç¶²åŸŸå¸³è™Ÿï¼‰
* SMBï¼ˆæª”æ¡ˆå…±äº«ï¼‰é€šè¨Šé©—è­‰
* RDPã€HTTPï¼ˆIISï¼‰ç­‰éœ€è¦ Windows é©—è­‰çš„æƒ…å¢ƒ
* åœ¨ Kerberos ç„¡æ³•ä½¿ç”¨æ™‚çš„ fallback èªè­‰æ–¹å¼

---

## ğŸ” NTLM çš„é‹ä½œåŸç†ï¼ˆæ‘˜è¦ï¼‰

NTLM é©—è­‰æ˜¯ä¸€ç¨® **æŒ‘æˆ°-å›æ‡‰ï¼ˆChallengeâ€“Responseï¼‰æ©Ÿåˆ¶**ï¼Œéç¨‹å¤§è‡´å¦‚ä¸‹ï¼š

1. **Client â†’ Serverï¼š**
   ç”¨æˆ¶ç«¯è«‹æ±‚ç™»å…¥ï¼ˆæä¾›å¸³è™Ÿåç¨±ï¼‰ã€‚

2. **Server â†’ Clientï¼š**
   ä¼ºæœå™¨ç”¢ç”Ÿä¸€å€‹éš¨æ©Ÿæ•¸ï¼ˆç¨±ç‚º *Challenge*ï¼‰ï¼Œå‚³çµ¦ç”¨æˆ¶ç«¯ã€‚

3. **Client â†’ Serverï¼š**
   ç”¨æˆ¶ç«¯ä½¿ç”¨å¯†ç¢¼çš„ **NT Hash**ï¼ˆç¶“é MD4 é›œæ¹Šçš„å¯†ç¢¼ï¼‰å»åŠ å¯†è©² Challengeï¼Œç”¢ç”Ÿ *Response*ï¼Œå†å‚³å›ä¼ºæœå™¨ã€‚

4. **Serverï¼š**
   ä¼ºæœå™¨åœ¨å…§éƒ¨åˆ©ç”¨å„²å­˜çš„ NT Hash é©—è­‰è©² Response æ˜¯å¦æ­£ç¢ºã€‚è‹¥ä¸€è‡´ï¼Œé©—è­‰é€šéã€‚

---

## ğŸ§  å»¶ä¼¸çŸ¥è­˜ï¼šNTLM Hash

* **LM Hashï¼ˆèˆŠçš„ï¼‰**ï¼šæ—©æœŸç‰ˆæœ¬ï¼Œå®‰å…¨æ€§éå¸¸ä½ï¼ˆåªæ”¯æ´å¤§å¯«ã€è¢«åˆ‡æˆå…©åŠã€å¯è¢«ç§’è§£ï¼‰ã€‚
* **NT Hashï¼ˆæ–°çš„ï¼‰**ï¼šä»¥ä½¿ç”¨è€…å¯†ç¢¼ç¶“é **MD4** é›œæ¹Šå¾Œç”¢ç”Ÿã€‚é€™å€‹å€¼å¸¸è¢«ç¨±ç‚ºã€ŒNTLM Hashã€ã€‚

åœ¨æ»²é€æ¸¬è©¦ä¸­ï¼Œè‹¥ä½ å–å¾—äº† `NTLM hash`ï¼Œå¯ä»¥ç”¨ï¼š

* **Pass-the-Hash æ”»æ“Š**ï¼šç›´æ¥ä½¿ç”¨ hash ç™»å…¥ï¼Œä¸éœ€çŸ¥é“æ˜æ–‡å¯†ç¢¼ã€‚
* **Hash cracking**ï¼šç”¨å¦‚ hashcat å˜—è©¦é‚„åŸå¯†ç¢¼ã€‚

---

## âš ï¸ å®‰å…¨å•é¡Œ

NTLM å­˜åœ¨å¤šé …å¼±é»ï¼š

* **ä¸ä½¿ç”¨åŠ é¹½ï¼ˆsaltï¼‰** â†’ å®¹æ˜“è¢«å½©è™¹è¡¨ç ´è§£
* **ä½¿ç”¨ MD4/MD5** â†’ é›œæ¹Šæ¼”ç®—æ³•éæ™‚
* **å¯è¢«é‡æ”¾æ”»æ“Šï¼ˆReplay attackï¼‰æˆ–ä¸­é–“äººæ”»æ“Šï¼ˆMITMï¼‰**
* **ä¸æ”¯æ´å¤šé‡é©—è­‰ï¼ˆMFAï¼‰**

å› æ­¤ï¼Œå¾®è»Ÿå®˜æ–¹å»ºè­°ï¼š

> ã€Œæ–°ç³»çµ±æ‡‰ç›¡é‡ä½¿ç”¨ Kerberos å–ä»£ NTLMã€‚ã€

---

## ğŸ ç°¡çŸ­å°ç…§è¡¨

| é …ç›®         | NTLM      | Kerberos       |
| ------------ | --------- | -------------- |
| é©—è­‰æ–¹å¼     | æŒ‘æˆ°-å›æ‡‰ | ç¥¨è­‰ï¼ˆTicketï¼‰ |
| é›œæ¹Šæ¼”ç®—æ³•   | MD4 / MD5 | AES / RC4      |
| åŠ é¹½æ©Ÿåˆ¶     | ç„¡        | æœ‰             |
| æ˜¯å¦æ”¯æ´ SSO | å¦        | æ˜¯             |
| å®‰å…¨æ€§       | è¼ƒä½      | è¼ƒé«˜           |

---

## ç ´è§£æ–¹æ³•:

### æ–¹æ³• 1: ä½¿ç”¨ Hashcat

```bash
# å‰µå»º hash æ–‡ä»¶
echo "30...50" > lab_hash.txt

# ä½¿ç”¨ rockyou.txt å­—å…¸ç ´è§£
hashcat -m 1000 -a 0 lab_hash.txt /usr/share/wordlists/rockyou.txt

# æˆ–ç›´æ¥åœ¨å‘½ä»¤è¡Œ
hashcat -m 1000 30...50 /usr/share/wordlists/rockyou.txt
```

### æ–¹æ³• 2: ä½¿ç”¨ John the Ripper

```bash
# å‰µå»ºæ–‡ä»¶æ ¼å¼: username:hash
echo "Lab:30...50" > lab_hash.txt

# ä½¿ç”¨ john ç ´è§£
john --format=NT lab_hash.txt --wordlist=/usr/share/wordlists/rockyou.txt

# æŸ¥çœ‹çµæœ
john --show --format=NT lab_hash.txt
```

### æ–¹æ³• 3: ç·šä¸Šç ´è§£

è¨ªå•é€™äº›ç¶²ç«™:
- https://crackstation.net/
- https://hashes.com/en/decrypt/hash

ç›´æ¥è²¼ä¸Š hash: `30...50`

### æ–¹æ³• 4: å¿«é€Ÿå˜—è©¦å¸¸è¦‹å¯†ç¢¼

```bash
# ä½¿ç”¨å°å­—å…¸å¿«é€Ÿæ¸¬è©¦
hashcat -m 1000 30...50 /usr/share/wordlists/fasttrack.txt
```

