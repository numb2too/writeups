
## 本地端口轉發
### 指令

`ssh -L 8080:10.10.66.36:8080 localhost`

### 每個部分的意思

* `ssh`：用 SSH 連線。
* `-L 8080:10.10.66.36:8080`：建立**本地端口轉發（local port forwarding）**。

  * 格式是 `-L <本地埠>:<遠端主機>:<遠端埠>`。
  * 這裡表示：把你電腦（client）上的 `localhost:8080` 綁定起來，任何連到 `localhost:8080` 的流量會透過 SSH 隧道送到 SSH 伺服器，然後由那台伺服器去連 `10.10.66.36:8080`。
* `localhost`：SSH 要連的目標主機。也就是你在 SSH 到哪台主機（在你的情況是連回本機的 sshd）。

### 執行後發生了什麼

1. 系統要求你輸入 `root@localhost` 的密碼——表示你在對本機的 SSH 伺服器做連線與認證。
2. 認證成功後，SSH 會顯示伺服器歡迎訊息（kernel、發行版資訊、last login 等），那段你貼的就是 welcome banner。
3. 同時 SSH 啟動一個**隧道**：把你本機 `127.0.0.1:8080` 與遠端（從 SSH 伺服器視角的）`10.10.66.36:8080` 連接起來。

   * 例如：在同一台機器上打開瀏覽器並訪問 `http://localhost:8080`，該請求會被送進 SSH 隧道，再由 SSH server 轉發去 `10.10.66.36:8080`，回傳也同樣經過隧道返回給你。
4. 當你關閉 SSH session（登出或用 Ctrl+C）時，這個隧道也會關閉。

### 為什麼會這樣做（常見用途）

* 想從你的電腦訪問內網或防火牆後面的服務（像是某台機器的 web 管理介面 8080），但那服務不能直接從你的機器存取。透過 SSH 隧道可以安全地把流量轉發過去。
* 在 CTF/滲透測試環境常見：你在跳板機/靶機上能看到某個內網 IP（10.10.66.36），但你本地瀏覽器看不到，就用 SSH -L 打隧道。

### 小提示

* 要測試：在本機瀏覽器開 `http://localhost:8080` 看能不能看到那服務頁面。
* 若只想建立隧道不想拿到 shell，可以加 `-N`（不執行遠端命令）與 `-f`（背景執行）：
  `ssh -f -N -L 8080:10.10.66.36:8080 localhost`
* 若 10.10.66.36 是 SSH server 自己（也就是 `localhost` 就能直接連），那直接用 localhost:8080 就可以，不用隧道；但如果 10.10.66.36 是 SSH server 能存取但你的本機不能直接存取（常見情況），隧道就有用。

### 參考
https://ivanitlearning.wordpress.com/2020/04/11/tryhackme-blueprint/
